<!DOCTYPE html>
<html class="writer-html5" lang="ru" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>10. Глава 22: Диалоговые Окна и Окна Сообщений &mdash; документация C &amp; GUI на RPi Zero 2 W 1.0</title>
      <link rel="stylesheet" href="../../static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../static/css/theme.css" type="text/css" />
  
        <script data-url_root="../../" id="documentation_options" src="../../static/documentation_options.js"></script>
        <script src="../../static/jquery.js"></script>
        <script src="../../static/underscore.js"></script>
        <script src="../../static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../static/doctools.js"></script>
        <script src="../../static/sphinx_highlight.js"></script>
        <script src="../../static/translations.js"></script>
    <script src="../../static/js/theme.js"></script>
    <link rel="index" title="Алфавитный указатель" href="../../genindex.html" />
    <link rel="search" title="Поиск" href="../../search.html" />
    <link rel="next" title="11. Глава 23: Предустановленные диалоги" href="../chapter23_builtin_dialogs/index.html" />
    <link rel="prev" title="9. Глава 21: Меню Приложений (GtkMenuBar, GtkMenu, GtkMenuItem)" href="../chapter21_menus/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            C & GUI на RPi Zero 2 W
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Поиск в документации" aria-label="Поиск в документации" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Меню навигации">
              <p class="caption" role="heading"><span class="caption-text">Содержание:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../part1_basics/index.html">Часть I: Основы языка Си</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Часть II: Разработка GUI с помощью GTK</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../chapter13_gtk_intro/index.html">1. Глава 13: Введение в GTK</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter14_first_project/index.html">2. Глава 14: Первый GTK-проект — Окно с кнопкой</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter15_buttons/index.html">3. Глава 15: Кнопки и обработка событий</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter16_labels_layout/index.html">4. Глава 16: Метки и Базовые Контейнеры Компоновки (GtkBox)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter17_grid_layout/index.html">5. Глава 17: Гибкая Компоновка с GtkGrid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter18_inputs/index.html">6. Глава 18: Элементы Пользовательского Ввода</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter19_comboboxes/index.html">7. Глава 19: Выпадающие Списки (ComboBox) и Модели Данных (ListStore)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter20_treeview/index.html">8. Глава 20: Деревья и Таблицы (GtkTreeView)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter21_menus/index.html">9. Глава 21: Меню Приложений (GtkMenuBar, GtkMenu, GtkMenuItem)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">10. Глава 22: Диалоговые Окна и Окна Сообщений</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">10.1. —</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">10.2. Компиляция и Запуск Примеров</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">10.3. Ожидаемый Результат</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">10.4. Дополнительные Ресурсы</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../chapter23_builtin_dialogs/index.html">11. Глава 23: Предустановленные диалоги</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter24_widget_customization/index.html">12. Глава 24: Настройка виджетов</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter25_glade/index.html">13. Глава 25: Glade – визуальный редактор интерфейсов</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../part3_projects/index.html">Часть III: Приложения и справка</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Меню навигации для мобильных устройств" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">C & GUI на RPi Zero 2 W</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Навигация по страницам">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Часть II: Разработка GUI с помощью GTK</a></li>
      <li class="breadcrumb-item active"><span class="section-number">10. </span>Глава 22: Диалоговые Окна и Окна Сообщений</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../sources/part2_gui/chapter22_dialogs/index.rst.txt" rel="nofollow"> Просмотреть исходный код страницы</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="id1">
<h1><span class="section-number">10. </span>Глава 22: Диалоговые Окна и Окна Сообщений<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h1>
<p>В этой главе мы освоим создание <strong>диалоговых окон</strong> в GTK. Диалоги — это временные окна, которые появляются поверх основного приложения для запроса информации, подтверждения действия или отображения важного сообщения. Они критически важны для взаимодействия с пользователем, позволяя запрашивать ввод, выбор файлов, отображать предупреждения, ошибки или просто информационные уведомления.</p>
<p>GTK предлагает два основных подхода для создания диалоговых окон:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.gtk.org/gtk3/class.MessageDialog.html">GtkMessageDialog</a>: Это специализированный и простой в использовании диалог, предназначенный для отображения стандартных сообщений (информация, предупреждение, ошибка, вопрос). Он быстро создается и настраивается для типовых сценариев.</p></li>
<li><p><a class="reference external" href="https://docs.gtk.org/gtk3/class.Dialog.html">GtkDialog</a>: Это более универсальный и настраиваемый базовый класс для всех диалоговых окон в GTK. Он позволяет создавать собственные диалоги с любым содержимым, заголовком, набором кнопок и поведением.</p></li>
</ul>
<p>—</p>
<p>### Основные понятия и функции</p>
<ul class="simple">
<li><p><strong>`gtk_message_dialog_new()`</strong>: Создаёт новый <cite>GtkMessageDialog</cite> с заданными параметрами.</p></li>
<li><p><strong>`gtk_dialog_run()`</strong>: Отображает диалог и запускает локальный цикл событий, ожидая действия пользователя. Возвращает ответ пользователя (например, OK, Cancel).</p></li>
<li><p><strong>`gtk_widget_destroy()`</strong>: Удаляет виджет из памяти. <strong>Важно</strong> вызывать для диалогов после <cite>gtk_dialog_run()</cite>.</p></li>
<li><p><strong>`gtk_dialog_new_with_buttons()`</strong>: Создаёт новый <cite>GtkDialog</cite> с заданным заголовком и предустановленными кнопками.</p></li>
<li><p><strong>`gtk_dialog_get_content_area()`</strong>: Получает указатель на область содержимого <cite>GtkDialog</cite>, куда можно добавлять свои виджеты.</p></li>
<li><p><strong>`GTK_DIALOG_DESTROY_WITH_PARENT`</strong>: Флаг для <cite>GtkMessageDialog</cite>, означающий, что диалог будет уничтожен вместе с родительским окном.</p></li>
<li><p><strong>`GTK_DIALOG_MODAL`</strong>: Флаг для <cite>GtkDialog</cite>, делающий его модальным, то есть блокирующим взаимодействие с родительским окном до своего закрытия.</p></li>
<li><p><strong>`GTK_MESSAGE_INFO`, `GTK_MESSAGE_WARNING`, `GTK_MESSAGE_ERROR`, `GTK_MESSAGE_QUESTION`</strong>: Типы сообщений для <cite>GtkMessageDialog</cite>, влияющие на его иконку.</p></li>
<li><p><strong>`GTK_BUTTONS_OK`, `GTK_BUTTONS_OK_CANCEL`, `GTK_BUTTONS_YES_NO`, `GTK_BUTTONS_NONE`</strong>: Предустановленные наборы кнопок для <cite>GtkMessageDialog</cite>.</p></li>
<li><p><strong>`GTK_RESPONSE_OK`, `GTK_RESPONSE_CANCEL`, `GTK_RESPONSE_YES`, `GTK_RESPONSE_NO`</strong>: Возвращаемые значения от <cite>gtk_dialog_run()</cite>, указывающие, какая кнопка была нажата.</p></li>
<li><p><strong>`gtk_label_new()`</strong>: Создаёт новый виджет метки (<cite>GtkLabel</cite>) с заданным текстом.</p></li>
<li><p><strong>`gtk_button_new_with_label()`</strong>: Создаёт новую кнопку (<cite>GtkButton</cite>) с текстовой меткой.</p></li>
</ul>
<section id="id2">
<h2><span class="section-number">10.1. </span>—<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h2>
<p>### Пример 22.1: Использование GtkMessageDialog</p>
<p><strong>Файл:</strong> <cite>message_dialog_example.c</cite></p>
<p>Этот пример демонстрирует, как создать и отобразить стандартное информационное сообщение с помощью <cite>GtkMessageDialog</cite>. Приложение состоит из основного окна с кнопкой. Нажатие этой кнопки вызывает диалоговое окно.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;gtk/gtk.h&gt;</span><span class="c1"> // Подключаем основную библиотеку GTK.</span>

<span class="cm">/**</span>
<span class="cm"> * @brief Callback-функция, вызываемая при нажатии кнопки в главном окне.</span>
<span class="cm"> * Отвечает за создание и отображение GtkMessageDialog.</span>
<span class="cm"> *</span>
<span class="cm"> * @param widget Указатель на кнопку, которая была нажата.</span>
<span class="cm"> * @param window Указатель на главное окно (родительское окно для диалога),</span>
<span class="cm"> * переданный через параметр `data` при подключении сигнала.</span>
<span class="cm"> */</span>
<span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">on_button_clicked</span><span class="p">(</span><span class="n">GtkWidget</span><span class="w"> </span><span class="o">*</span><span class="n">widget</span><span class="p">,</span><span class="w"> </span><span class="n">gpointer</span><span class="w"> </span><span class="n">window</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">GtkWidget</span><span class="w"> </span><span class="o">*</span><span class="n">dialog</span><span class="p">;</span><span class="w"> </span><span class="c1">// Декларация указателя на диалоговое окно.</span>

<span class="w">    </span><span class="c1">// Создаем новый GtkMessageDialog.</span>
<span class="w">    </span><span class="c1">// Параметры:</span>
<span class="w">    </span><span class="c1">// 1. GTK_WINDOW(window): Родительское окно для диалога.</span>
<span class="w">    </span><span class="c1">//    Это обеспечивает правильное позиционирование диалога и его уничтожение при закрытии родителя.</span>
<span class="w">    </span><span class="c1">// 2. GTK_DIALOG_DESTROY_WITH_PARENT: Флаг поведения диалога.</span>
<span class="w">    </span><span class="c1">//    Означает, что диалог будет автоматически уничтожен, если его родительское окно будет закрыто.</span>
<span class="w">    </span><span class="c1">// 3. GTK_MESSAGE_INFO: Тип сообщения. Определяет иконку, которая будет отображаться в диалоге (информационная).</span>
<span class="w">    </span><span class="c1">//    Другие варианты: GTK_MESSAGE_WARNING, GTK_MESSAGE_ERROR, GTK_MESSAGE_QUESTION.</span>
<span class="w">    </span><span class="c1">// 4. GTK_BUTTONS_OK: Набор кнопок, которые будут присутствовать в диалоге.</span>
<span class="w">    </span><span class="c1">//    Здесь будет только кнопка &quot;OK&quot;. Другие: GTK_BUTTONS_OK_CANCEL, GTK_BUTTONS_YES_NO.</span>
<span class="w">    </span><span class="c1">// 5. &quot;Это информационное сообщение.&quot;: Формат строки сообщения. Работает как printf.</span>
<span class="w">    </span><span class="n">dialog</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtk_message_dialog_new</span><span class="p">(</span><span class="n">GTK_WINDOW</span><span class="p">(</span><span class="n">window</span><span class="p">),</span>
<span class="w">                                    </span><span class="n">GTK_DIALOG_DESTROY_WITH_PARENT</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">GTK_MESSAGE_INFO</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">GTK_BUTTONS_OK</span><span class="p">,</span>
<span class="w">                                    </span><span class="s">&quot;Это информационное сообщение.&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Запускаем диалог. Эта функция отображает диалог и блокирует</span>
<span class="w">    </span><span class="c1">// основное окно до тех пор, пока пользователь не закроет диалог (нажав кнопку).</span>
<span class="w">    </span><span class="c1">// Она возвращает значение GTK_RESPONSE_..., соответствующее нажатой кнопке.</span>
<span class="w">    </span><span class="c1">// В данном случае, поскольку есть только кнопка &quot;OK&quot;, она вернет GTK_RESPONSE_OK.</span>
<span class="w">    </span><span class="n">gtk_dialog_run</span><span class="p">(</span><span class="n">GTK_DIALOG</span><span class="p">(</span><span class="n">dialog</span><span class="p">));</span>

<span class="w">    </span><span class="c1">// Уничтожаем диалог после того, как он был закрыт.</span>
<span class="w">    </span><span class="c1">// Это освобождает выделенные для него ресурсы.</span>
<span class="w">    </span><span class="n">gtk_widget_destroy</span><span class="p">(</span><span class="n">dialog</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * @brief Главная функция программы.</span>
<span class="cm"> *</span>
<span class="cm"> * Инициализирует GTK, создает основное окно с кнопкой,</span>
<span class="cm"> * которая при нажатии отображает GtkMessageDialog.</span>
<span class="cm"> *</span>
<span class="cm"> * @param argc Количество аргументов командной строки.</span>
<span class="cm"> * @param argv Массив строк аргументов командной строки.</span>
<span class="cm"> * @return Код завершения программы.</span>
<span class="cm"> */</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">argv</span><span class="p">[])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">GtkWidget</span><span class="w"> </span><span class="o">*</span><span class="n">window</span><span class="p">;</span><span class="w"> </span><span class="c1">// Указатель на главное окно.</span>
<span class="w">    </span><span class="n">GtkWidget</span><span class="w"> </span><span class="o">*</span><span class="n">button</span><span class="p">;</span><span class="w"> </span><span class="c1">// Указатель на кнопку.</span>

<span class="w">    </span><span class="n">gtk_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">argv</span><span class="p">);</span><span class="w"> </span><span class="c1">// Инициализация библиотеки GTK.</span>

<span class="w">    </span><span class="c1">// 1. Создание главного окна.</span>
<span class="w">    </span><span class="n">window</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtk_window_new</span><span class="p">(</span><span class="n">GTK_WINDOW_TOPLEVEL</span><span class="p">);</span>
<span class="w">    </span><span class="n">gtk_window_set_title</span><span class="p">(</span><span class="n">GTK_WINDOW</span><span class="p">(</span><span class="n">window</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Пример MessageDialog&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">gtk_window_set_default_size</span><span class="p">(</span><span class="n">GTK_WINDOW</span><span class="p">(</span><span class="n">window</span><span class="p">),</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="mi">150</span><span class="p">);</span>
<span class="w">    </span><span class="n">gtk_window_set_position</span><span class="p">(</span><span class="n">GTK_WINDOW</span><span class="p">(</span><span class="n">window</span><span class="p">),</span><span class="w"> </span><span class="n">GTK_WIN_POS_CENTER</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Подключаем сигнал &quot;destroy&quot; окна к функции gtk_main_quit.</span>
<span class="w">    </span><span class="n">g_signal_connect</span><span class="p">(</span><span class="n">window</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;destroy&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">G_CALLBACK</span><span class="p">(</span><span class="n">gtk_main_quit</span><span class="p">),</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 2. Создание кнопки.</span>
<span class="w">    </span><span class="n">button</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtk_button_new_with_label</span><span class="p">(</span><span class="s">&quot;Показать сообщение&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Подключаем сигнал &quot;clicked&quot; кнопки к нашей функции on_button_clicked.</span>
<span class="w">    </span><span class="c1">// В качестве пользовательских данных (data) передаем указатель на главное окно,</span>
<span class="w">    </span><span class="c1">// чтобы функция on_button_clicked могла использовать его как родителя для диалога.</span>
<span class="w">    </span><span class="n">g_signal_connect</span><span class="p">(</span><span class="n">button</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;clicked&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">G_CALLBACK</span><span class="p">(</span><span class="n">on_button_clicked</span><span class="p">),</span><span class="w"> </span><span class="n">window</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 3. Добавление кнопки в окно.</span>
<span class="w">    </span><span class="n">gtk_container_add</span><span class="p">(</span><span class="n">GTK_CONTAINER</span><span class="p">(</span><span class="n">window</span><span class="p">),</span><span class="w"> </span><span class="n">button</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 4. Отображение всех виджетов и запуск главного цикла GTK.</span>
<span class="w">    </span><span class="n">gtk_widget_show_all</span><span class="p">(</span><span class="n">window</span><span class="p">);</span>
<span class="w">    </span><span class="n">gtk_main</span><span class="p">();</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>—</p>
<p>### Пример 22.2: Создание Кастомного GtkDialog</p>
<p><strong>Файл:</strong> <cite>custom_dialog_example.c</cite></p>
<p>В этом примере мы создаем более гибкий, <strong>пользовательский диалог</strong> с помощью <cite>GtkDialog</cite>. Мы добавляем в него метку с вопросом и две кнопки («OK» и «Отмена»). Программа отслеживает, какая из кнопок была нажата пользователем, и выводит соответствующее сообщение в консоль.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;gtk/gtk.h&gt;</span><span class="c1"> // Подключаем основную библиотеку GTK.</span>

<span class="cm">/**</span>
<span class="cm"> * @brief Callback-функция, вызываемая при нажатии кнопки в главном окне.</span>
<span class="cm"> * Отвечает за создание, настройку и отображение кастомного GtkDialog.</span>
<span class="cm"> *</span>
<span class="cm"> * @param widget Указатель на кнопку, которая была нажата.</span>
<span class="cm"> * @param window Указатель на главное окно (родительское окно для диалога).</span>
<span class="cm"> */</span>
<span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">on_button_clicked</span><span class="p">(</span><span class="n">GtkWidget</span><span class="w"> </span><span class="o">*</span><span class="n">widget</span><span class="p">,</span><span class="w"> </span><span class="n">gpointer</span><span class="w"> </span><span class="n">window</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">GtkWidget</span><span class="w"> </span><span class="o">*</span><span class="n">dialog</span><span class="p">;</span><span class="w">       </span><span class="c1">// Указатель на диалоговое окно.</span>
<span class="w">    </span><span class="n">gint</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">             </span><span class="c1">// Переменная для хранения результата (какая кнопка была нажата).</span>
<span class="w">    </span><span class="n">GtkWidget</span><span class="w"> </span><span class="o">*</span><span class="n">content_area</span><span class="p">;</span><span class="w"> </span><span class="c1">// Область содержимого диалога, куда мы добавим нашу метку.</span>
<span class="w">    </span><span class="n">GtkWidget</span><span class="w"> </span><span class="o">*</span><span class="n">label</span><span class="p">;</span><span class="w">        </span><span class="c1">// Метка для отображения текста в диалоге.</span>

<span class="w">    </span><span class="c1">// Создаем новый GtkDialog с предопределенными кнопками.</span>
<span class="w">    </span><span class="c1">// Параметры:</span>
<span class="w">    </span><span class="c1">// 1. &quot;Кастомный диалог&quot;: Заголовок диалогового окна.</span>
<span class="w">    </span><span class="c1">// 2. GTK_WINDOW(window): Родительское окно.</span>
<span class="w">    </span><span class="c1">// 3. GTK_DIALOG_MODAL: Флаг, делающий диалог модальным. Это означает, что</span>
<span class="w">    </span><span class="c1">//    пользователь не сможет взаимодействовать с родительским окном,</span>
<span class="w">    </span><span class="c1">//    пока этот диалог открыт.</span>
<span class="w">    </span><span class="c1">// 4. &quot;_OK&quot;: Текст первой кнопки. Подчеркивание `_` используется для создания мнемонического доступа</span>
<span class="w">    </span><span class="c1">//    (например, Alt+O, если это поддерживается системой).</span>
<span class="w">    </span><span class="c1">// 5. GTK_RESPONSE_OK: Значение, которое `gtk_dialog_run()` вернет, если будет нажата эта кнопка.</span>
<span class="w">    </span><span class="c1">// 6. &quot;_Отмена&quot;: Текст второй кнопки.</span>
<span class="w">    </span><span class="c1">// 7. GTK_RESPONSE_CANCEL: Значение, возвращаемое при нажатии этой кнопки.</span>
<span class="w">    </span><span class="c1">// 8. NULL: Обозначает конец списка кнопок.</span>
<span class="w">    </span><span class="n">dialog</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtk_dialog_new_with_buttons</span><span class="p">(</span><span class="s">&quot;Кастомный диалог&quot;</span><span class="p">,</span>
<span class="w">                                         </span><span class="n">GTK_WINDOW</span><span class="p">(</span><span class="n">window</span><span class="p">),</span>
<span class="w">                                         </span><span class="n">GTK_DIALOG_MODAL</span><span class="p">,</span>
<span class="w">                                         </span><span class="s">&quot;_OK&quot;</span><span class="p">,</span>
<span class="w">                                         </span><span class="n">GTK_RESPONSE_OK</span><span class="p">,</span>
<span class="w">                                         </span><span class="s">&quot;_Отмена&quot;</span><span class="p">,</span>
<span class="w">                                         </span><span class="n">GTK_RESPONSE_CANCEL</span><span class="p">,</span>
<span class="w">                                         </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Получаем область содержимого диалога.</span>
<span class="w">    </span><span class="c1">// Это GtkBox, куда можно добавлять любые виджеты, формируя пользовательский интерфейс диалога.</span>
<span class="w">    </span><span class="n">content_area</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtk_dialog_get_content_area</span><span class="p">(</span><span class="n">GTK_DIALOG</span><span class="p">(</span><span class="n">dialog</span><span class="p">));</span>

<span class="w">    </span><span class="c1">// Создаем метку с вопросом.</span>
<span class="w">    </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtk_label_new</span><span class="p">(</span><span class="s">&quot;Вы хотите продолжить?&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Добавляем метку в область содержимого диалога.</span>
<span class="w">    </span><span class="n">gtk_container_add</span><span class="p">(</span><span class="n">GTK_CONTAINER</span><span class="p">(</span><span class="n">content_area</span><span class="p">),</span><span class="w"> </span><span class="n">label</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Отображаем все виджеты в диалоге (метку и кнопки).</span>
<span class="w">    </span><span class="n">gtk_widget_show_all</span><span class="p">(</span><span class="n">dialog</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Запускаем диалог и получаем ответ пользователя.</span>
<span class="w">    </span><span class="c1">// Эта функция блокирует выполнение программы до закрытия диалога.</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtk_dialog_run</span><span class="p">(</span><span class="n">GTK_DIALOG</span><span class="p">(</span><span class="n">dialog</span><span class="p">));</span>

<span class="w">    </span><span class="c1">// Анализируем результат, чтобы определить, какая кнопка была нажата.</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">GTK_RESPONSE_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">g_print</span><span class="p">(</span><span class="s">&quot;Пользователь нажал OK</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">GTK_RESPONSE_CANCEL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">g_print</span><span class="p">(</span><span class="s">&quot;Пользователь нажал Отмена</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Может быть GTK_RESPONSE_NONE, если диалог был закрыт другим способом (например, кнопкой закрытия окна).</span>
<span class="w">        </span><span class="n">g_print</span><span class="p">(</span><span class="s">&quot;Диалог был закрыт без явного выбора OK/Отмена</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Уничтожаем диалог после его использования.</span>
<span class="w">    </span><span class="c1">// Это освобождает ресурсы, которые он занимал.</span>
<span class="w">    </span><span class="n">gtk_widget_destroy</span><span class="p">(</span><span class="n">dialog</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * @brief Главная функция программы.</span>
<span class="cm"> *</span>
<span class="cm"> * Инициализирует GTK, создает основное окно с кнопкой,</span>
<span class="cm"> * которая при нажатии отображает кастомный GtkDialog.</span>
<span class="cm"> *</span>
<span class="cm"> * @param argc Количество аргументов командной строки.</span>
<span class="cm"> * @param argv Массив строк аргументов командной строки.</span>
<span class="cm"> * @return Код завершения программы.</span>
<span class="cm"> */</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">argv</span><span class="p">[])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">GtkWidget</span><span class="w"> </span><span class="o">*</span><span class="n">window</span><span class="p">;</span><span class="w"> </span><span class="c1">// Указатель на главное окно.</span>
<span class="w">    </span><span class="n">GtkWidget</span><span class="w"> </span><span class="o">*</span><span class="n">button</span><span class="p">;</span><span class="w"> </span><span class="c1">// Указатель на кнопку.</span>

<span class="w">    </span><span class="n">gtk_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">argv</span><span class="p">);</span><span class="w"> </span><span class="c1">// Инициализация библиотеки GTK.</span>

<span class="w">    </span><span class="c1">// 1. Создание главного окна.</span>
<span class="w">    </span><span class="n">window</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtk_window_new</span><span class="p">(</span><span class="n">GTK_WINDOW_TOPLEVEL</span><span class="p">);</span>
<span class="w">    </span><span class="n">gtk_window_set_title</span><span class="p">(</span><span class="n">GTK_WINDOW</span><span class="p">(</span><span class="n">window</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Пример Кастомного Диалога&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">gtk_window_set_default_size</span><span class="p">(</span><span class="n">GTK_WINDOW</span><span class="p">(</span><span class="n">window</span><span class="p">),</span><span class="w"> </span><span class="mi">350</span><span class="p">,</span><span class="w"> </span><span class="mi">150</span><span class="p">);</span>
<span class="w">    </span><span class="n">gtk_window_set_position</span><span class="p">(</span><span class="n">GTK_WINDOW</span><span class="p">(</span><span class="n">window</span><span class="p">),</span><span class="w"> </span><span class="n">GTK_WIN_POS_CENTER</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Подключаем сигнал &quot;destroy&quot; окна.</span>
<span class="w">    </span><span class="n">g_signal_connect</span><span class="p">(</span><span class="n">window</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;destroy&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">G_CALLBACK</span><span class="p">(</span><span class="n">gtk_main_quit</span><span class="p">),</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 2. Создание кнопки.</span>
<span class="w">    </span><span class="n">button</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtk_button_new_with_label</span><span class="p">(</span><span class="s">&quot;Открыть диалог&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Подключаем сигнал &quot;clicked&quot; кнопки к нашей функции on_button_clicked,</span>
<span class="w">    </span><span class="c1">// передавая главное окно в качестве пользовательских данных.</span>
<span class="w">    </span><span class="n">g_signal_connect</span><span class="p">(</span><span class="n">button</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;clicked&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">G_CALLBACK</span><span class="p">(</span><span class="n">on_button_clicked</span><span class="p">),</span><span class="w"> </span><span class="n">window</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 3. Добавление кнопки в окно.</span>
<span class="w">    </span><span class="n">gtk_container_add</span><span class="p">(</span><span class="n">GTK_CONTAINER</span><span class="p">(</span><span class="n">window</span><span class="p">),</span><span class="w"> </span><span class="n">button</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 4. Отображение всех виджетов и запуск главного цикла GTK.</span>
<span class="w">    </span><span class="n">gtk_widget_show_all</span><span class="p">(</span><span class="n">window</span><span class="p">);</span>
<span class="w">    </span><span class="n">gtk_main</span><span class="p">();</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>—</p>
</section>
<section id="id3">
<h2><span class="section-number">10.2. </span>Компиляция и Запуск Примеров<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h2>
<p>Сохраните каждый пример кода в соответствующий файл: <cite>message_dialog_example.c</cite> и <cite>custom_dialog_example.c</cite>.</p>
<p>### Компиляция:</p>
<p>Для сборки программ используйте следующие команды в терминале, находясь в директории с исходными файлами. Убедитесь, что у вас установлен GTK 3.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Для примера с GtkMessageDialog:</span>
gcc<span class="w"> </span>message_dialog_example.c<span class="w"> </span>-o<span class="w"> </span>message_dialog_example<span class="w"> </span><span class="sb">`</span>pkg-config<span class="w"> </span>--cflags<span class="w"> </span>--libs<span class="w"> </span>gtk+-3.0<span class="sb">`</span>

<span class="c1"># Для примера с Кастомным GtkDialog:</span>
gcc<span class="w"> </span>custom_dialog_example.c<span class="w"> </span>-o<span class="w"> </span>custom_dialog_example<span class="w"> </span><span class="sb">`</span>pkg-config<span class="w"> </span>--cflags<span class="w"> </span>--libs<span class="w"> </span>gtk+-3.0<span class="sb">`</span>
</pre></div>
</div>
<p>### Запуск:</p>
<p>После успешной компиляции вы можете запустить каждое приложение:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Для примера с GtkMessageDialog:</span>
./message_dialog_example

<span class="c1"># Для примера с Кастомным GtkDialog:</span>
./custom_dialog_example
</pre></div>
</div>
<p>—</p>
</section>
<section id="id4">
<h2><span class="section-number">10.3. </span>Ожидаемый Результат<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><dl class="simple">
<dt><strong>`message_dialog_example`</strong>:</dt><dd><ul>
<li><p>Откроется основное окно с заголовком <strong>«Пример MessageDialog»</strong> и одной кнопкой <strong>«Показать сообщение»</strong>.</p></li>
<li><p>При нажатии на эту кнопку появится <strong>всплывающее диалоговое окно</strong> с заголовком, иконкой информации, текстом «Это информационное сообщение.» и одной кнопкой <strong>«OK»</strong>.</p></li>
<li><p>После нажатия «OK» диалог закроется, и управление вернется к основному окну.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>`custom_dialog_example`</strong>:</dt><dd><ul>
<li><p>Откроется основное окно с заголовком <strong>«Пример Кастомного Диалога»</strong> и кнопкой <strong>«Открыть диалог»</strong>.</p></li>
<li><p>При нажатии на эту кнопку появится <strong>модальное диалоговое окно</strong> с заголовком <strong>«Кастомный диалог»</strong>.</p></li>
<li><p>Внутри диалога будет отображаться текст <strong>«Вы хотите продолжить?»</strong> и две кнопки: <strong>«OK»</strong> и <strong>«Отмена»</strong>.</p></li>
<li><p>Если вы нажмете <strong>«OK»</strong>, диалог закроется, и в консоли появится сообщение <strong>«Пользователь нажал OK»</strong>.</p></li>
<li><p>Если вы нажмете <strong>«Отмена»</strong>, диалог закроется, и в консоли появится сообщение <strong>«Пользователь нажал Отмена»</strong>.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>—</p>
</section>
<section id="id5">
<h2><span class="section-number">10.4. </span>Дополнительные Ресурсы<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.gtk.org/gtk3/class.Dialog.html">GtkDialog</a></p></li>
<li><p><a class="reference external" href="https://docs.gtk.org/gtk3/class.MessageDialog.html">GtkMessageDialog</a></p></li>
<li><p><a class="reference external" href="https://docs.gtk.org/gtk3/enum.ButtonsType.html">GtkButtonsType</a></p></li>
<li><p><a class="reference external" href="https://docs.gtk.org/gtk3/enum.ResponseType.html">GtkResponseType</a></p></li>
<li><p><a class="reference external" href="https://github.com/AIDevelopersMonster/C_GUI_Handbook">C_GUI_Handbook GitHub</a></p></li>
</ul>
<p>—</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Нижняя область">
        <a href="../chapter21_menus/index.html" class="btn btn-neutral float-left" title="9. Глава 21: Меню Приложений (GtkMenuBar, GtkMenu, GtkMenuItem)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Предыдущая</a>
        <a href="../chapter23_builtin_dialogs/index.html" class="btn btn-neutral float-right" title="11. Глава 23: Предустановленные диалоги" accesskey="n" rel="next">Следующая <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, KONTAKTS &amp; Garvis.</p>
  </div>

  Собрано при помощи <a href="https://www.sphinx-doc.org/">Sphinx</a> с использованием
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">темы,</a>
    предоставленной <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>