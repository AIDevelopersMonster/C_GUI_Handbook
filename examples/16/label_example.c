#include <gtk/gtk.h> // Подключаем основную библиотеку GTK.
                       // Этот заголовочный файл содержит все необходимые определения
                       // для создания графических интерфейсов с помощью GTK.

/**
 * @brief Главная функция программы, точка входа.
 *
 * Эта функция отвечает за инициализацию GTK, создание основного окна,
 * добавление метки и запуск главного цикла обработки событий.
 *
 * @param argc Количество аргументов командной строки, переданных программе.
 * @param argv Массив строк аргументов командной строки. GTK может использовать
 * эти аргументы для своих внутренних настроек (например, `--display`).
 * @return Код завершения программы (0 при успешном выполнении, отличное от 0 в случае ошибки).
 */
int main(int argc, char *argv[]) {
    // Инициализация GTK.
    // Это первый и обязательный вызов в любой GTK-программе.
    // Он подготавливает библиотеку к работе, обрабатывает специфические
    // для GTK аргументы командной строки и устанавливает базовые параметры.
    gtk_init(&argc, &argv);

    // Создание главного окна приложения.
    // GtkWidget* - это универсальный указатель на любой виджет в GTK.
    // gtk_window_new(GTK_WINDOW_TOPLEVEL) создает новое окно верхнего уровня,
    // которое является независимым окном на рабочем столе.
    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);

    // Установка заголовка окна.
    // GTK_WINDOW(window) - это макрос, который "приводит" (casts) универсальный
    // GtkWidget* к более специфичному типу GtkWindow*, необходимому для функций
    // работы с окнами.
    gtk_window_set_title(GTK_WINDOW(window), "Пример с GtkLabel");

    // Установка размера окна по умолчанию (ширина, высота в пикселях).
    // Пользователь сможет изменить этот размер вручную.
    gtk_window_set_default_size(GTK_WINDOW(window), 300, 100);

    // Установка начального положения окна на экране.
    // GTK_WIN_POS_CENTER центрирует окно по центру экрана при его первом появлении.
    gtk_window_set_position(GTK_WINDOW(window), GTK_WIN_POS_CENTER);

    // Подключение сигнала "destroy" к функции gtk_main_quit.
    // Сигнал "destroy" испускается, когда пользователь пытается закрыть окно
    // (например, кликая на кнопку "X" в заголовке или используя Alt+F4).
    // gtk_main_quit() останавливает главный цикл событий GTK, что приводит к
    // корректному завершению работы программы. Это критически важно для
    // предотвращения "зависания" приложения после закрытия окна.
    g_signal_connect(window, "destroy", G_CALLBACK(gtk_main_quit), NULL);

    // Создание метки (текстового виджета) с заданным текстом.
    // GtkLabel - это виджет, который отображает статический текст.
    // Важно: если вы используете символы не из ASCII (например, русские буквы),
    // убедитесь, что ваш исходный файл (.c) сохранен в кодировке UTF-8.
    // Иначе могут возникнуть предупреждения Pango или неправильное отображение текста.
    GtkWidget *label = gtk_label_new("Привет, GTK!");

    // Добавление метки в окно.
    // GtkWindow является контейнером для одного дочернего виджета.
    // gtk_container_add() добавляет 'label' в 'window'.
    // GTK_CONTAINER(window) - еще одно приведение типа для работы с окном как с контейнером.
    // Поскольку окно содержит только одну метку, GTK автоматически центрирует её.
    gtk_container_add(GTK_CONTAINER(window), label);

    // Отображение всех виджетов в окне.
    // По умолчанию виджеты создаются невидимыми. gtk_widget_show_all() делает
    // видимым само окно и все виджеты, которые в него добавлены.
    gtk_widget_show_all(window);

    // Запуск главного цикла обработки событий GTK.
    // Эта функция передает управление библиотеке GTK. Программа переходит в
    // режим ожидания событий (кликов мышью, нажатий клавиш, системных сообщений).
    // Этот цикл продолжается до тех пор, пока не будет вызвана функция gtk_main_quit().
    gtk_main();

    // Возвращаем 0, что является стандартным кодом успешного завершения программы.
    return 0;
}